<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <div id="player"></div>
        <button>play/pause</button>
        <script>
            const API_URL = 'http://localhost:3000'
            function onYouTubeIframeAPIReady() {
                player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: 'M7lc1UVf-VE',
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
                });
            }

            function onPlayerReady(event) {
                event.target.playVideo();
            }

            var done = false;
            function onPlayerStateChange(event) {
                if (event.data == YT.PlayerState.PLAYING && !done) {
                    setTimeout(stopVideo, 6000);
                    done = true;
                }
                fetch(API_URL + '/youtube-events', {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({type: event.data})
                }).then(response => console.log('response', response))
            }
            function stopVideo() {
                player.stopVideo();
            }
        </script>
        <script src="https://youtube.com/iframe_api"></script>
    </body>
</html>